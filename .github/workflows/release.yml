name: release

on:
  push:
    branches:
      - main

jobs:
  semver:
    runs-on: ubuntu-latest
    outputs:
      semver: ""
    steps:
      - name: Semver
        id: setsemver
        run: echo "::set-output name=semver::"
      - name: Semver failure
        if: steps.setsemver.outputs.semver ==  ''
        run: |
          exit 1

  publish:
    runs-on: ubuntu-latest
    needs: [semver]
    if: always() && needs.semver.outputs.semver != ''
    steps:
      - name: Publish
        run: |
          exit 0

  release:
    runs-on: ubuntu-latest
    needs: [publish]

    steps:
      - name: Release
        run: |
          exit 0

  clean-up:
    runs-on: ubuntu-latest
    needs: [release]
    if: failure()
    steps:
      - name: Cleanup
        run: |
          exit 0
  
  deploy:
    runs-on: ubuntu-latest
    needs: [release]
    steps:
      - name: Deploy
        run: |
          exit 0